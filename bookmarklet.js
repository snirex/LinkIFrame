javascript:(function(){/** Hover timer */let hoverTimer=null;/** חלונות פתוחים */let windowStack=[];/** מוסיף האזנה לכל הקישורים */document.querySelectorAll("a").forEach(link=>{link.addEventListener("mouseenter",()=>{hoverTimer=setTimeout(()=>{showIframe(link.href)},3000)}),link.addEventListener("mouseleave",()=>{clearTimeout(hoverTimer)})});/** סגירה עם ESC */document.addEventListener("keydown",event=>{if(event.key==="Escape"&&windowStack.length){const topWindow=windowStack[windowStack.length-1];topWindow.div.style.opacity="0",topWindow.div.style.transform="translate(+50%, +50%) scale(0.3)",setTimeout(()=>{topWindow.div.remove(),windowStack=windowStack.filter(w=>w.div!==topWindow.div)},300)}});/** פונקציה ליצירת חלון iframe */function showIframe(url){const previewBox=document.createElement("div");previewBox.style.position="fixed",previewBox.style.top=(50+windowStack.length*20)+"%",previewBox.style.left=(50+windowStack.length*20)+"%",previewBox.style.transform="translate(-50%, -50%) scale(0.8)",previewBox.style.width="500px",previewBox.style.height="500px",previewBox.style.background="white",previewBox.style.border="2px solid #444",previewBox.style.zIndex=1000+windowStack.length,previewBox.style.boxShadow="0 4px 15px rgba(0,0,0,0.4)",previewBox.style.borderRadius="10px",previewBox.style.overflow="hidden",previewBox.style.opacity="0",previewBox.style.transition="all 0.3s ease";/** header לגרירה וכפתורים */const header=document.createElement("div");header.style.height="30px",header.style.background="#f0f0f0",header.style.cursor="move",header.style.display="flex",header.style.alignItems="center",header.style.justifyContent="space-between",header.style.padding="0 10px",header.style.borderBottom="1px solid #ccc";/** כותרת (ניתנת לעריכה) */const titleSpan=document.createElement("input");titleSpan.type="text",titleSpan.value="טוען...",titleSpan.style.flex="1",titleSpan.style.fontSize="14px",titleSpan.style.fontWeight="bold",titleSpan.style.border="none",titleSpan.style.background="transparent",titleSpan.style.outline="none",titleSpan.style.overflow="hidden",titleSpan.style.whiteSpace="nowrap",titleSpan.style.textOverflow="ellipsis",titleSpan.addEventListener("keydown",event=>{"Enter"===event.key&&searchInIframe(previewBox.querySelector("iframe"),titleSpan.value)});/** div לכפתורים */const buttonsDiv=document.createElement("div");buttonsDiv.style.display="flex",buttonsDiv.style.alignItems="center";const buttonStyle={cursor:"pointer",fontSize:"16px",marginRight:"5px",transition:"color 0.2s ease"};function makeButton(icon,title,clickHandler){const button=document.createElement("div");button.innerHTML=icon,button.title=title,Object.assign(button.style,buttonStyle),button.addEventListener("mouseenter",()=>{button.style.color="#007bff"}),button.addEventListener("mouseleave",()=>{button.style.color="#000"}),button.addEventListener("click",clickHandler);return button}const openButton=makeButton("↗","פתח בטאב חדש",()=>{window.open(url,"_blank")});const closeButton=makeButton("✕","סגור",()=>{previewBox.style.opacity="0",previewBox.style.transform="translate(+50%, +50%) scale(0.3)",setTimeout(()=>{previewBox.remove(),windowStack=windowStack.filter(w=>w.div!==previewBox)},100)});let minimized=false,originalHeight="500px";const minimizeButton=makeButton("−","צמצם/הגדל",()=>{minimized?(previewBox.style.height=originalHeight,minimizeButton.innerHTML="−",minimized=false):(originalHeight=previewBox.style.height,previewBox.style.height="30px",minimizeButton.innerHTML="+",minimized=true)});const openInPageButton=makeButton("💻","פתח בדף הראשי",()=>{const iframeTag=previewBox.querySelector("iframe");iframeTag&&iframeTag.src&&(window.location.href=iframeTag.src)});const refreshButton=makeButton("⟳","רענן",()=>{const iframeTag=previewBox.querySelector("iframe");iframeTag&&(iframeTag.src=iframeTag.src)});const forwardButton=makeButton("→","קדימה",()=>{const iframeTag=previewBox.querySelector("iframe");iframeTag&&iframeTag.contentWindow.history.forward()});const backButton=makeButton("←","אחורה",()=>{const iframeTag=previewBox.querySelector("iframe");iframeTag&&iframeTag.contentWindow.history.back()});let isFull=false;const fullButton=makeButton("⛶","מסך מלא",()=>{if(!isFull){previewBox.dataset.prevWidth=previewBox.style.width,previewBox.dataset.prevHeight=previewBox.style.height,previewBox.dataset.prevTop=previewBox.style.top,previewBox.dataset.prevLeft=previewBox.style.left,previewBox.dataset.prevTransform=previewBox.style.transform,previewBox.style.width="100%",previewBox.style.height="100%",previewBox.style.top="0",previewBox.style.left="0",previewBox.style.bottom="auto",previewBox.style.transform="translate(0,0) scale(1)",isFull=true}else{previewBox.style.width=previewBox.dataset.prevWidth,previewBox.style.height=previewBox.dataset.prevHeight,previewBox.style.left="50%",previewBox.style.top="auto",previewBox.style.bottom="0",previewBox.style.transform="translate(-50%, 0) scale(1)",isFull=false}});const copyButton=makeButton("📋","העתק URL",()=>{const iframeTag=previewBox.querySelector("iframe");iframeTag&&navigator.clipboard.writeText(iframeTag.src)});/** הוספת הכפתורים ל־header */buttonsDiv.appendChild(copyButton),buttonsDiv.appendChild(fullButton),buttonsDiv.appendChild(forwardButton),buttonsDiv.appendChild(backButton),buttonsDiv.appendChild(refreshButton),buttonsDiv.appendChild(openInPageButton),buttonsDiv.appendChild(openButton),buttonsDiv.appendChild(minimizeButton),buttonsDiv.appendChild(closeButton),header.appendChild(titleSpan),header.appendChild(buttonsDiv);/** iframe */const iframe=document.createElement("iframe");iframe.src=url,iframe.style.width="100%",iframe.style.height="calc(100% - 30px)",iframe.style.border="none";/** resizer */const resizer=document.createElement("div");resizer.style.width="15px",resizer.style.height="15px",resizer.style.position="absolute",resizer.style.right="0",resizer.style.bottom="0",resizer.style.cursor="se-resize",resizer.style.background="transparent";previewBox.appendChild(header),previewBox.appendChild(iframe),previewBox.appendChild(resizer),document.body.appendChild(previewBox),setTimeout(()=>{previewBox.style.opacity="1",previewBox.style.transform="translate(-50%, -50%) scale(1)"},10),makeDraggable(previewBox,header),makeResizable(previewBox,resizer,iframe),iframe.addEventListener("load",()=>{try{titleSpan.value=iframe.contentDocument.title||"ללא כותרת"}catch(e){titleSpan.value="ללא כותרת"}}),windowStack.push({div:previewBox})}/** גרירה */function makeDraggable(element,handle){let offsetX=0,offsetY=0,isDown=false;handle.addEventListener("mousedown",event=>{isDown=true,offsetX=event.clientX-element.getBoundingClientRect().left,offsetY=event.clientY-element.getBoundingClientRect().top,document.body.style.userSelect="none",element.style.transition="none"}),document.addEventListener("mouseup",()=>{isDown&&(element.style.transition="all 0.3s ease"),isDown=false,document.body.style.userSelect="auto"}),document.addEventListener("mousemove",event=>{if(!isDown)return;element.style.top=event.clientY-offsetY+"px",element.style.left=event.clientX-offsetX+"px",element.style.transform="translate(0,0) scale(1)"})}/** שינוי גודל */function makeResizable(element,resizer,iframe){let isResizing=false;resizer.addEventListener("mousedown",event=>{isResizing=true,document.body.style.userSelect="none",element.style.transition="none",event.preventDefault()}),document.addEventListener("mousemove",event=>{if(!isResizing)return;const rect=element.getBoundingClientRect();let newWidth=event.clientX-rect.left,newHeight=event.clientY-rect.top;newWidth>200&&(element.style.width=newWidth+"px"),newHeight>150&&(element.style.height=newHeight+"px"),iframe.style.height="calc(100% - 30px)"}),document.addEventListener("mouseup",()=>{isResizing&&(element.style.transition="all 0.3s ease"),isResizing=false,document.body.style.userSelect="auto"})}/** חיפוש בתוך iframe */function searchInIframe(iframe,text){try{const body=iframe.contentDocument.body;if(!body)return;const found=body.innerHTML.includes(text);alert(found?"נמצא":"לא נמצא")}catch(e){alert("חיפוש לא זמין (CORS)")}}})();
